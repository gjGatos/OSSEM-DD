name: 'Event ID 600: Provider Lifecycle'
description: Logs the start and stop of PowerShell providers. If the provider started
  is equal to <strong>WSMan</strong>, then it indicates the use rof PowerShell remoting
platform: windows
log_source: PowerShell
event_id: '600'
event_version: '0'
event_fields:
- standard_name: EventProviderName
  standard_type: TBD
  name: ProviderName
  type: string
  description: ''
  sample_value: Variable
- standard_name: PowershellNewProviderState
  standard_type: TBD
  name: NewProviderState
  type: string
  description: ''
  sample_value: Started
- standard_name: PowershellSequenceNumber
  standard_type: TBD
  name: SequenceNumber
  type: integer
  description: ''
  sample_value: '11'
- standard_name: PowershellHostName
  standard_type: TBD
  name: HostName
  type: string
  description: ''
  sample_value: ConsoleHost
- standard_name: PowershellHostVersion
  standard_type: TBD
  name: HostVersion
  type: string
  description: ''
  sample_value: 5.1.16299.251
- standard_name: PowershellHostId
  standard_type: TBD
  name: HostId
  type: string
  description: ''
  sample_value: 7839f0de-2e81-4a34-beb3-526dc9f11385
- standard_name: PowershellHostApplication
  standard_type: TBD
  name: HostApplication
  type: string
  description: ''
  sample_value: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
- standard_name: PowershellEngineVersion
  standard_type: TBD
  name: EngineVersion
  type: string
  description: ''
  sample_value: ''
- standard_name: PowershellRunspaceId
  standard_type: TBD
  name: RunspaceId
  type: string
  description: ''
  sample_value: ''
- standard_name: PowershellPipelineId
  standard_type: TBD
  name: PipelineId
  type: string
  description: ''
  sample_value: ''
- standard_name: PowershellCommandName
  standard_type: TBD
  name: CommandName
  type: string
  description: ''
  sample_value: ''
- standard_name: PowershellCommandType
  standard_type: TBD
  name: CommandType
  type: string
  description: ''
  sample_value: ''
- standard_name: PowershellScriptName
  standard_type: TBD
  name: ScriptName
  type: string
  description: ''
  sample_value: ''
- standard_name: PowershellCommandPath
  standard_type: TBD
  name: CommandPath
  type: string
  description: ''
  sample_value: ''
- standard_name: PowershellCommandLine
  standard_type: TBD
  name: CommandLine
  type: string
  description: ''
  sample_value: ''
references:
- text: Investigating PowerShell Attacks - Mandiant
  link: https://www.defcon.org/images/defcon-22/dc-22-presentations/Kazanciyan-Hastings/DEFCON-22-Ryan-Kazanciyan-Matt-Hastings-Investigating-Powershell-Attacks.pdf
tags: []
event_sample:
- format: friendly view
  sample: "Log Name:      Windows PowerShell\nSource:        PowerShell\nDate:   \
    \       9/22/2022 6:55:17 AM\nEvent ID:      600\nTask Category: Provider Lifecycle\n\
    Level:         Information\nKeywords:      Classic\nUser:          N/A\nComputer:\
    \      pedro-computer\nDescription:\nProvider \"Registry\" is Started. \n\nDetails:\
    \ \n  ProviderName=Registry\n  NewProviderState=Started\n\n  SequenceNumber=1\n\
    \n  HostName=Windows PowerShell ISE Host\n  HostVersion=5.1.18362.1\n  HostId=d996dfd5-2169-4004-9778-05d3e65cf75c\n\
    \  HostApplication=C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\PowerShell_ISE.exe\n\
    \  EngineVersion=\n  RunspaceId=\n  PipelineId=\n  CommandName=\n  CommandType=\n\
    \  ScriptName=\n  CommandPath=\n  CommandLine="
- format: xml
  sample: "<Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\"\
    >\n  <System>\n    <Provider Name=\"PowerShell\" />\n    <EventID Qualifiers=\"\
    0\">600</EventID>\n    <Level>4</Level>\n    <Task>6</Task>\n    <Keywords>0x80000000000000</Keywords>\n\
    \    <TimeCreated SystemTime=\"2022-09-22T13:55:17.139711400Z\" />\n    <EventRecordID>135</EventRecordID>\n\
    \    <Channel>Windows PowerShell</Channel>\n    <Computer>pedro-computer</Computer>\n\
    \    <Security />\n  </System>\n  <EventData>\n    <Data>Registry</Data>\n   \
    \ <Data>Started</Data>\n    <Data>\tProviderName=Registry\n  NewProviderState=Started\n\
    \n  SequenceNumber=1\n\n  HostName=Windows PowerShell ISE Host\n  HostVersion=5.1.18362.1\n\
    \  HostId=d996dfd5-2169-4004-9778-05d3e65cf75c\n  HostApplication=C:\\Windows\\\
    system32\\WindowsPowerShell\\v1.0\\PowerShell_ISE.exe\n  EngineVersion=\n  RunspaceId=\n\
    \  PipelineId=\n  CommandName=\n  CommandType=\n  ScriptName=\n  CommandPath=\n\
    \  CommandLine=</Data>\n  </EventData>\n</Event>"
