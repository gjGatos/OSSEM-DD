name: 'Event ID 4698: A scheduled task was created'
description: This event generates every time a new scheduled task is created.
platform: windows
log_source: Microsoft-Windows-Security-Auditing
event_id: '4698'
event_version: '0'
event_fields:
- standard_name: UserSid
  standard_type: TBD
  name: SubjectUserSid
  type: SID
  description: SID of account that requested the "create scheduled task" operation.Â 
  sample_value: S-1-5-21-3457937927-2839227994-823803824-1104
- standard_name: UserName
  standard_type: TBD
  name: SubjectUserName
  type: UnicodeString
  description: the name of the account that requested the "create scheduled task"
    operation.
  sample_value: UserName
- standard_name: Domain
  standard_type: TBD
  name: SubjectDomainName
  type: UnicodeString
  description: subject's domain or computer name.
  sample_value: DOMAIN
- standard_name: UserLogonId
  standard_type: TBD
  name: SubjectLogonId
  type: HexInt64
  description: hexadecimal value that can help you correlate this event with recent
    events that might contain the same Logon ID
  sample_value: '0x364eb'
- standard_name: ScheduledTaskName
  standard_type: TBD
  name: TaskName
  type: UnicodeString
  description: new scheduled task name.
  sample_value: \Microsoft\StartListener
- standard_name: ScheduledTaskContent
  standard_type: TBD
  name: TaskContent
  type: UnicodeString
  description: the XML content of the new task.
  sample_value: <?xml version="1.0" encoding="UTF-16"?> <Task version="1.2" xmlns="http://schemas.microsoft.com/windows/2004/02/mit/task">
    <RegistrationInfo> <Date>2015-09-22T19:03:06.9258653</Date> <Author>CONTOSO\\dadmin</Author>
    </RegistrationInfo> <Triggers /> <Principals> <Principal id="Author"> <RunLevel>LeastPrivilege</RunLevel>
    <UserId>CONTOSO\\dadmin</UserId> <LogonType>InteractiveToken</LogonType> </Principal>
    </Principals> <Settings> <MultipleInstancesPolicy>IgnoreNew </MultipleInstancesPolicy>
    <DisallowStartIfOnBatteries>true </DisallowStartIfOnBatteries> <StopIfGoingOnBatteries>true
    </StopIfGoingOnBatteries> <AllowHardTerminate>true</AllowHardTerminate> <StartWhenAvailable>false</StartWhenAvailable>
    <RunOnlyIfNetworkAvailable> false</RunOnlyIfNetworkAvailable> <IdleSettings> <StopOnIdleEnd>true
    </StopOnIdleEnd> <RestartOnIdle>false</RestartOnIdle> </IdleSettings> <AllowStartOnDemand>true</AllowStartOnDemand>
    <Enabled>true</Enabled> <Hidden>false</Hidden> <RunOnlyIfIdle>false</RunOnlyIfIdle>
    <WakeToRun>false </WakeToRun> <ExecutionTimeLimit>P3D</ExecutionTimeLimit> <Priority>7
    </Priority> </Settings> <Actions Context="Author"> <Exec> <Command> C:\\Documents\\listener.exe</Command>
    </Exec> </Actions> </Task></Data>
references:
- text: MS Source
  link: https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4698.md
- text: MS Security Auditing Category - Object Access
  link: https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/advanced-security-audit-policy-settings#object-access
- text: MS Security Auditing Sub-category - Audit Other Object Access Events
  link: https://github.com/MicrosoftDocs/windows-itpro-docs/tree/master/windows/security/threat-protection/auditing/audit-other-object-access-events.md
tags:
- etw_level_Informational
- etw_task_task_0
- Object Access
- Audit Other Object Access Events
event_sample:
- format: friendly view
  sample: "Log Name:      Security \nSource:        Microsoft-Windows-Security-Auditing\
    \ \nDate:          9/12/2022 7:44:00 AM \nEvent ID:      4698 \nTask Category:\
    \ Other Object Access Events \nLevel:         Information \nKeywords:      Audit\
    \ Success \nUser:          N/A \nComputer:      pedro-computer \nDescription:\
    \   A scheduled task was created. \nSubject: \n  Security ID:\t\tPEDRO-COMPUTER\\\
    pedro-admin \n  Account Name:\t\tpedro-admin \n  Account Domain:\t\tPEDRO-COMPUTER\
    \ \n  Logon ID:\t\t0x10D8F33 \nTask Information: \n  Task Name: \t\t\\PERSISTENCE\
    \ \n  Task Content: \t\t<?xml version=\"1.0\" encoding=\"UTF-16\"?> \n<Task version=\"\
    1.2\" xmlns=\"http://schemas.microsoft.com/windows/2004/02/mit/task\"> \n  <RegistrationInfo>\
    \ \n    <Date>2022-09-12T07:44:00</Date> \n    <Author>PEDRO-COMPUTER\\pedro-admin</Author>\
    \ \n    <URI>\\PERSISTENCE</URI> \n  </RegistrationInfo> \n  <Triggers> \n   \
    \ <TimeTrigger> \n      <Repetition> \n        <Interval>PT1M</Interval> \n  \
    \      <StopAtDurationEnd>false</StopAtDurationEnd> \n      </Repetition> \n \
    \     <StartBoundary>2022-09-12T07:44:00</StartBoundary> \n      <Enabled>true</Enabled>\
    \ \n    </TimeTrigger> \n  </Triggers> \n  <Settings> \n    <MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>\
    \ \n    <DisallowStartIfOnBatteries>true</DisallowStartIfOnBatteries> \n    <StopIfGoingOnBatteries>true</StopIfGoingOnBatteries>\
    \ \n    <AllowHardTerminate>true</AllowHardTerminate> \n    <StartWhenAvailable>false</StartWhenAvailable>\
    \ \n    <RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable> \n    <IdleSettings>\
    \ \n      <Duration>PT10M</Duration> \n      <WaitTimeout>PT1H</WaitTimeout> \n\
    \      <StopOnIdleEnd>true</StopOnIdleEnd> \n      <RestartOnIdle>false</RestartOnIdle>\
    \ \n    </IdleSettings> \n    <AllowStartOnDemand>true</AllowStartOnDemand> \n\
    \    <Enabled>true</Enabled> \n    <Hidden>false</Hidden> \n    <RunOnlyIfIdle>false</RunOnlyIfIdle>\
    \ \n    <WakeToRun>false</WakeToRun> \n    <ExecutionTimeLimit>PT72H</ExecutionTimeLimit>\
    \ \n    <Priority>7</Priority> \n  </Settings> \n  <Actions Context=\"Author\"\
    > \n    <Exec> \n      <Command>C:\\Users\\persistence\\persistence.exe</Command>\
    \ \n    </Exec> \n  </Actions> \n  <Principals> \n    <Principal id=\"Author\"\
    > \n      <UserId>PEDRO-COMPUTER\\pedro-admin</UserId> \n      <LogonType>InteractiveToken</LogonType>\
    \ \n      <RunLevel>LeastPrivilege</RunLevel> \n    </Principal> \n  </Principals>\
    \ \n</Task> "
- format: xml
  sample: "<Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\"\
    > \n  <System> \n    <Provider Name=\"Microsoft-Windows-Security-Auditing\" Guid=\"\
    {54849625-5478-4994-a5ba-3e3b0328c30d}\" /> \n    <EventID>4698</EventID> \n \
    \   <Version>0</Version> \n    <Level>0</Level> \n    <Task>12804</Task> \n  \
    \  <Opcode>0</Opcode> \n    <Keywords>0x8020000000000000</Keywords> \n    <TimeCreated\
    \ SystemTime=\"2022-09-12T14:44:00.897503800Z\" /> \n    <EventRecordID>140595</EventRecordID>\
    \ \n    <Correlation ActivityID=\"{cf6cb87c-ae9a-0000-91b9-6ccf9aaed801}\" />\
    \ \n    <Execution ProcessID=\"616\" ThreadID=\"7728\" /> \n    <Channel>Security</Channel>\
    \ \n    <Computer>pedro-computer</Computer> \n    <Security /> \n  </System> \n\
    \  <EventData> \n    <Data Name=\"SubjectUserSid\">S-1-5-21-3768430097-3400800235-1714852860-1001</Data>\
    \ \n    <Data Name=\"SubjectUserName\">pedro-admin</Data> \n    <Data Name=\"\
    SubjectDomainName\">PEDRO-COMPUTER</Data> \n    <Data Name=\"SubjectLogonId\"\
    >0x10d8f33</Data> \n    <Data Name=\"TaskName\">\\PERSISTENCE</Data> \n    <Data\
    \ Name=\"TaskContent\">&lt;?xml version=\"1.0\" encoding=\"UTF-16\"?&gt; \n  \
    \    &lt;Task version=\"1.2\" xmlns=\"http://schemas.microsoft.com/windows/2004/02/mit/task\"\
    &gt; \n        &lt;RegistrationInfo&gt; \n          &lt;Date&gt;2022-09-12T07:44:00&lt;/Date&gt;\
    \ \n          &lt;Author&gt;PEDRO-COMPUTER\\pedro-admin&lt;/Author&gt; \n    \
    \      &lt;URI&gt;\\PERSISTENCE&lt;/URI&gt; \n        &lt;/RegistrationInfo&gt;\
    \ \n        &lt;Triggers&gt; \n          &lt;TimeTrigger&gt; \n            &lt;Repetition&gt;\
    \ \n              &lt;Interval&gt;PT1M&lt;/Interval&gt; \n              &lt;StopAtDurationEnd&gt;false&lt;/StopAtDurationEnd&gt;\
    \ \n            &lt;/Repetition&gt; \n            &lt;StartBoundary&gt;2022-09-12T07:44:00&lt;/StartBoundary&gt;\
    \ \n            &lt;Enabled&gt;true&lt;/Enabled&gt; \n          &lt;/TimeTrigger&gt;\
    \ \n        &lt;/Triggers&gt; \n        &lt;Settings&gt; \n          &lt;MultipleInstancesPolicy&gt;IgnoreNew&lt;/MultipleInstancesPolicy&gt;\
    \ \n          &lt;DisallowStartIfOnBatteries&gt;true&lt;/DisallowStartIfOnBatteries&gt;\
    \ \n          &lt;StopIfGoingOnBatteries&gt;true&lt;/StopIfGoingOnBatteries&gt;\
    \ \n          &lt;AllowHardTerminate&gt;true&lt;/AllowHardTerminate&gt; \n   \
    \       &lt;StartWhenAvailable&gt;false&lt;/StartWhenAvailable&gt; \n        \
    \  &lt;RunOnlyIfNetworkAvailable&gt;false&lt;/RunOnlyIfNetworkAvailable&gt; \n\
    \          &lt;IdleSettings&gt; \n            &lt;Duration&gt;PT10M&lt;/Duration&gt;\
    \ \n            &lt;WaitTimeout&gt;PT1H&lt;/WaitTimeout&gt; \n            &lt;StopOnIdleEnd&gt;true&lt;/StopOnIdleEnd&gt;\
    \ \n            &lt;RestartOnIdle&gt;false&lt;/RestartOnIdle&gt; \n          &lt;/IdleSettings&gt;\
    \ \n          &lt;AllowStartOnDemand&gt;true&lt;/AllowStartOnDemand&gt; \n   \
    \       &lt;Enabled&gt;true&lt;/Enabled&gt; \n          &lt;Hidden&gt;false&lt;/Hidden&gt;\
    \ \n          &lt;RunOnlyIfIdle&gt;false&lt;/RunOnlyIfIdle&gt; \n          &lt;WakeToRun&gt;false&lt;/WakeToRun&gt;\
    \ \n          &lt;ExecutionTimeLimit&gt;PT72H&lt;/ExecutionTimeLimit&gt; \n  \
    \        &lt;Priority&gt;7&lt;/Priority&gt; \n        &lt;/Settings&gt; \n   \
    \     &lt;Actions Context=\"Author\"&gt; \n          &lt;Exec&gt; \n         \
    \   &lt;Command&gt;C:\\Users\\persistence\\persistence.exe&lt;/Command&gt; \n\
    \          &lt;/Exec&gt; \n        &lt;/Actions&gt; \n        &lt;Principals&gt;\
    \ \n          &lt;Principal id=\"Author\"&gt; \n            &lt;UserId&gt;PEDRO-COMPUTER\\\
    pedro-admin&lt;/UserId&gt; \n            &lt;LogonType&gt;InteractiveToken&lt;/LogonType&gt;\
    \ \n            &lt;RunLevel&gt;LeastPrivilege&lt;/RunLevel&gt; \n          &lt;/Principal&gt;\
    \ \n        &lt;/Principals&gt; \n      &lt;/Task&gt;</Data> \n  </EventData>\
    \ \n</Event> "
